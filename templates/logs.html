<!DOCTYPE html>
<html>
<head>
    <title>APRS Bot - Dashboard de Logs</title>
    <meta charset="UTF-8">
    <style>
        body { 
            font-family: Arial, sans-serif; 
            background: #1a1a1a; 
            color: #fff; 
            margin: 0; 
            padding: 20px; 
        }
        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
        }
        .header { 
            background: #2d3748; 
            padding: 20px; 
            border-radius: 8px; 
            margin-bottom: 20px; 
        }
        .logs-container { 
            background: #2d3748; 
            padding: 20px; 
            border-radius: 8px; 
            height: 500px; 
            overflow-y: auto; 
        }
        .log-line { 
            padding: 5px 0; 
            border-bottom: 1px solid #4a5568; 
            font-family: monospace; 
        }
        .stats { 
            background: #2d3748; 
            padding: 15px; 
            border-radius: 8px; 
            margin-bottom: 20px; 
        }
        .refresh-btn { 
            background: #48bb78; 
            color: white; 
            border: none; 
            padding: 10px 20px; 
            border-radius: 5px; 
            cursor: pointer; 
        }
        .timestamp { 
            color: #81c784; 
        }
        .error { 
            color: #f56565; 
        }
        .info { 
            color: #63b3ed; 
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü§ñ APRS Telegram Bot - Dashboard</h1>
            <button class="refresh-btn" onclick="refreshLogs()">üîÑ Actualizar</button>
            <span id="lastUpdate"></span>
        </div>
        
        <div class="stats" id="stats">
            <h3>üìä Estad√≠sticas del Contenedor</h3>
            <div id="statsContent">Cargando...</div>
        </div>
        
        <div class="logs-container" id="logsContainer">
            <h3>üìù Logs en Tiempo Real</h3>
            <div id="logs">Cargando logs...</div>
        </div>
    </div>

    <script>
        function refreshLogs() {
            fetch('/api/logs')
                .then(response => response.json())
                .then(data => {
                    const logsDiv = document.getElementById('logs');
                    logsDiv.innerHTML = '';
                    
                    data.logs.forEach(log => {
                        if (log.trim()) {
                            const div = document.createElement('div');
                            div.className = 'log-line';
                            
                            // Colorear seg√∫n el tipo de log
                            if (log.includes('ERROR')) {
                                div.className += ' error';
                            } else if (log.includes('INFO')) {
                                div.className += ' info';
                            }
                            
                            div.textContent = log;
                            logsDiv.appendChild(div);
                        }
                    });
                    
                    document.getElementById('lastUpdate').textContent = 
                        `√öltima actualizaci√≥n: ${new Date().toLocaleTimeString()}`;
                    
                    // Auto-scroll al final
                    const container = document.getElementById('logsContainer');
                    container.scrollTop = container.scrollHeight;
                })
                .catch(error => {
                    console.error('Error:', error);
                    document.getElementById('logs').innerHTML = 
                        '<div class="error">Error al cargar logs: ' + error + '</div>';
                });
        }
        
        function refreshStats() {
            fetch('/api/stats')
                .then(response => response.json())
                .then(data => {
                    if (data.error) {
                        document.getElementById('statsContent').innerHTML = 
                            '<span class="error">Error: ' + data.error + '</span>';
                    } else {
                        document.getElementById('statsContent').innerHTML = `
                            <strong>CPU:</strong> ${data.CPUPerc || 'N/A'} | 
                            <strong>Memoria:</strong> ${data.MemUsage || 'N/A'} | 
                            <strong>Estado:</strong> Running
                        `;
                    }
                })
                .catch(error => {
                    document.getElementById('statsContent').innerHTML = 
                        '<span class="error">Error al cargar estad√≠sticas</span>';
                });
        }
        
        // Actualizar autom√°ticamente cada 10 segundos
        setInterval(refreshLogs, 10000);
        setInterval(refreshStats, 30000);
        
        // Cargar inicial
        refreshLogs();
        refreshStats();
    </script>
</body>
</html>